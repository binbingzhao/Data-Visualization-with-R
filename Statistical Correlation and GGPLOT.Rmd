---
title: "Statistical Correlation and GGPLOT"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

**Step 1- Load the relevant libraries**

```{r step1, echo=TRUE}
library(ggplot2)
library(DataExplorer)
```

**Step 2 - Create a correlation matrix of the Iris dataset using the DataExplorer correlation function. Include only continuous variables in correlation plot to avoid confusion as factor variables don't make sense in a correlation plot**

```{r step2, echo=TRUE}
plot_correlation(iris, type = c("continuous"), title = "Correlation Matrix of Iris")
```

**Step 3 - Create three separate correlation matrices for each species of iris flower **

```{r step3, echo=TRUE}
setosa <- iris[iris$Species == 'setosa',c("Sepal.Length","Sepal.Width","Petal.Length","Petal.Width")]
plot_correlation(setosa, title = "Correlation Matrix for Setosa")
versicolor <- iris[iris$Species == 'versicolor',c("Sepal.Length","Sepal.Width","Petal.Length","Petal.Width")]
plot_correlation(versicolor, title = "Correlation Matrix for Versicolor")
virginica <- iris[iris$Species == 'virginica',c("Sepal.Length","Sepal.Width","Petal.Length","Petal.Width")]
plot_correlation(virginica, title = "Correlation Matrix for Virginica")
```

**Step 4 - Create a box plot of Petal Length by flower species. Make each box plot a different color for each species**

```{r step4, echo=TRUE}
box <- ggplot(data=iris, aes(x=Species, y=Petal.Length))
box + geom_boxplot(aes(fill=Species)) + 
  ylab("Petal Length") + ggtitle("Iris Boxplot") +
  stat_summary(fun.y=mean, geom="point", shape=5, size=4) 
```

**Step 5 - Create a Scatter jitter plot of Petal Width on the x axis vs. Petal Length on y axis, for the species of flower you identify in your boxplot that has the smallest median Petal Length**

```{r step5, echo=TRUE}
setosa <- iris[iris$Species == 'setosa',c("Sepal.Length","Sepal.Width","Petal.Length","Petal.Width")]
ggplot(setosa)+
  xlab("Petal Width")+
  ylab("Petal Length")+
  ggtitle("Scatter Jitter Plot of Setosa")+
  geom_point(aes(x = setosa$Petal.Width,y = setosa$Petal.Length),position = "jitter")
```

**Step 6 - Now switch this plot to scatter point without the jitter. There appears to be an outlier point on the right of the graph that has Petal Width of 0.6.**

```{r step6, echo=TRUE}
ggplot(setosa)+
    xlab("Petal Width")+
    ylab("Petal Length")+
    ggtitle("Scatterplot of Setosa")+
geom_point(aes(x = setosa$Petal.Width, y = setosa$Petal.Length, color =setosa$Petal.Width>0.5), show.legend = FALSE)
```

**Step 7- Finally, create a vertical bar graph that sums observations by flower species after filtering the Iris dataset to only observations with Sepal Length less than 6.** 

```{r step7, echo=TRUE}
data_filter<- iris[iris$Sepal.Length<6,]
data_count<- data.frame(table(data_filter$Species))
names(data_count)=c("Species","Count")
data_ordered<-data_count[order(data_count$Count, decreasing = TRUE),]
ggplot(data = data_ordered,mapping = aes(x=reorder(Species, -Count),y=Count,label = Count))+
  geom_bar(stat="identity",
           fill = c("#56B4E9","#E69F00","#999999"))+
  xlab("")+
  geom_text(nudge_y = +3, color = 'blue')+
  ggtitle("Bar Graph by Species with Sepal Lenght less than 6")
```

